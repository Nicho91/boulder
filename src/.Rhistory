strip.text.x = element_text(size = 8),
legend.position = c(0.7,0.85),
legend.background = element_blank(),
legend.key = element_blank())
alum_op_melt <- melt(alum_data[,c(1,3:4)], id = "date")
p2 <- alum_op_melt %>% ggplot() +
geom_point(aes(date, value, col = variable)) +
labs(title = "Alum OP Concentration at Dosing",
x = "Date",
y = "Hourly OP (mg/L)") +
scale_color_brewer(palette = "Dark2", name = "Location", labels = c("Dosing Station", "Effluent")) +
theme(legend.title = element_text(size = 8),
legend.text = element_text(size = 7),
plot.title = element_text(face="bold", size = 9, hjust = 0.5),
axis.text = element_text(size = 6),
axis.title = element_text(size = 9),
strip.text.x = element_text(size = 8),
legend.position = c(0.67,0.75),
legend.background = element_blank(),
legend.key = element_blank())
grid.arrange(p1, p2, ncol = 2)
ferr_op_melt <- melt(ferr_data[,c(1,3:4)], id = "date")
p1 <- ferr_op_melt %>% ggplot() +
geom_point(aes(date, value, col = variable)) +
labs(title = "Ferric OP Concentration at Dosing",
x = "Date",
y = "Hourly OP (mg/L)") +
scale_color_brewer(palette = "Dark2", name = "Location", labels = c("Dosing Station", "Effluent")) +
theme(legend.title = element_text(size = 8),
legend.text = element_text(size = 7),
plot.title = element_text(face="bold", size = 9, hjust = 0.5),
axis.text = element_text(size = 6),
axis.title = element_text(size = 9),
strip.text.x = element_text(size = 8),
legend.position = c(0.7,0.88),
legend.background = element_blank(),
legend.key = element_blank())
alum_op_melt <- melt(alum_data[,c(1,3:4)], id = "date")
p2 <- alum_op_melt %>% ggplot() +
geom_point(aes(date, value, col = variable)) +
labs(title = "Alum OP Concentration at Dosing",
x = "Date",
y = "Hourly OP (mg/L)") +
scale_color_brewer(palette = "Dark2", name = "Location", labels = c("Dosing Station", "Effluent")) +
theme(legend.title = element_text(size = 8),
legend.text = element_text(size = 7),
plot.title = element_text(face="bold", size = 9, hjust = 0.5),
axis.text = element_text(size = 6),
axis.title = element_text(size = 9),
strip.text.x = element_text(size = 8),
legend.position = c(0.67,0.75),
legend.background = element_blank(),
legend.key = element_blank())
grid.arrange(p1, p2, ncol = 2)
ferr_op_melt <- melt(ferr_data[,c(1,3:4)], id = "date")
p1 <- ferr_op_melt %>% ggplot() +
geom_point(aes(date, value, col = variable)) +
labs(title = "Ferric OP Concentration at Dosing",
x = "Date",
y = "Hourly OP (mg/L)") +
scale_color_brewer(palette = "Dark2", name = "Location", labels = c("Dosing Station", "Effluent")) +
theme(legend.title = element_text(size = 8),
legend.text = element_text(size = 7),
plot.title = element_text(face="bold", size = 9, hjust = 0.5),
axis.text = element_text(size = 6),
axis.title = element_text(size = 9),
strip.text.x = element_text(size = 8),
legend.position = c(0.7,0.89),
legend.background = element_blank(),
legend.key = element_blank())
alum_op_melt <- melt(alum_data[,c(1,3:4)], id = "date")
p2 <- alum_op_melt %>% ggplot() +
geom_point(aes(date, value, col = variable)) +
labs(title = "Alum OP Concentration at Dosing",
x = "Date",
y = "Hourly OP (mg/L)") +
scale_color_brewer(palette = "Dark2", name = "Location", labels = c("Dosing Station", "Effluent")) +
theme(legend.title = element_text(size = 8),
legend.text = element_text(size = 7),
plot.title = element_text(face="bold", size = 9, hjust = 0.5),
axis.text = element_text(size = 6),
axis.title = element_text(size = 9),
strip.text.x = element_text(size = 8),
legend.position = c(0.67,0.75),
legend.background = element_blank(),
legend.key = element_blank())
grid.arrange(p1, p2, ncol = 2)
ferr_op_melt <- melt(ferr_data[,c(1,3:4)], id = "date")
p1 <- ferr_op_melt %>% ggplot() +
geom_point(aes(date, value, col = variable)) +
labs(title = "Ferric OP Concentration at Dosing",
x = "Date",
y = "Hourly OP (mg/L)") +
scale_color_brewer(palette = "Dark2", name = "Location", labels = c("Dosing Station", "Effluent")) +
theme(legend.title = element_text(size = 8),
legend.text = element_text(size = 7),
plot.title = element_text(face="bold", size = 9, hjust = 0.5),
axis.text = element_text(size = 6),
axis.title = element_text(size = 9),
strip.text.x = element_text(size = 8),
legend.position = c(0.7,0.89),
legend.background = element_blank(),
legend.key = element_blank())
alum_op_melt <- melt(alum_data[,c(1,3:4)], id = "date")
p2 <- alum_op_melt %>% ggplot() +
geom_point(aes(date, value, col = variable)) +
labs(title = "Alum OP Concentration at Dosing",
x = "Date",
y = "Hourly OP (mg/L)") +
scale_color_brewer(palette = "Dark2", name = "Location", labels = c("Dosing Station", "Effluent")) +
theme(legend.title = element_text(size = 8),
legend.text = element_text(size = 7),
plot.title = element_text(face="bold", size = 9, hjust = 0.5),
axis.text = element_text(size = 6),
axis.title = element_text(size = 9),
strip.text.x = element_text(size = 8),
legend.position = c(0.7,0.89),
legend.background = element_blank(),
legend.key = element_blank())
grid.arrange(p1, p2, ncol = 2)
ferr_op_melt <- melt(ferr_data[,c(1,3:4)], id = "date")
p1 <- ferr_op_melt %>% ggplot() +
geom_point(aes(date, value, col = variable)) +
labs(title = "Ferric OP Concentration at Dosing",
x = "Date",
y = "Hourly OP (mg/L)") +
scale_color_brewer(palette = "Dark2", name = "Location", labels = c("Dosing Station", "Effluent")) +
theme(legend.title = element_text(size = 8),
legend.text = element_text(size = 7),
plot.title = element_text(face="bold", size = 9, hjust = 0.5),
axis.text = element_text(size = 6),
axis.title = element_text(size = 9),
strip.text.x = element_text(size = 8),
legend.position = c(0.7,0.89),
legend.background = element_blank(),
legend.key = element_blank())
alum_op_melt <- melt(alum_data[,c(1,3:4)], id = "date")
p2 <- alum_op_melt %>% ggplot() +
geom_point(aes(date, value, col = variable)) +
labs(title = "Alum OP Concentration at Dosing",
x = "Date",
y = "Hourly OP (mg/L)") +
scale_color_brewer(palette = "Dark2", name = "Location", labels = c("Dosing Station", "Effluent")) +
theme(legend.title = element_text(size = 8),
legend.text = element_text(size = 7),
plot.title = element_text(face="bold", size = 9, hjust = 0.5),
axis.text = element_text(size = 6),
axis.title = element_text(size = 9),
strip.text.x = element_text(size = 8),
legend.position = c(0.7,0.89),
legend.background = element_blank(),
legend.key = element_blank())
grid.arrange(p1, p2, ncol = 2)
ggplot(ferr_melt3) +
geom_boxplot(aes(y=value, fill=variable), outlier.size = 0.5, outlier.color = "red") +
facet_wrap(vars(hour), labeller = labeller(hour = hours)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
legend.title = element_text(size = 9),
legend.text = element_text(size = 9),
plot.title = element_text(face="bold", size = 9, hjust = 0.5),
axis.text = element_text(size = 6),
axis.title = element_text(size = 9),
strip.text.x = element_text(size = 8),
legend.position = "bottom")
load("/Users/haosheng/Desktop/boulder/data/final-data.rda")
load("/Users/haosheng/Desktop/boulder/data/boulderMoWater.rda")
ggplot(ferr_melt6) +
geom_boxplot(aes(y=value, fill=variable), outlier.size = 0.5, outlier.color = "red") +
facet_wrap(vars(hour), labeller = labeller(hour = hours)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
legend.title = element_text(size = 9),
legend.text = element_text(size = 9),
plot.title = element_text(face="bold", size = 9, hjust = 0.5),
axis.text = element_text(size = 6),
axis.title = element_text(size = 9),
strip.text.x = element_text(size = 8),
legend.position = "bottom")
p1 <- ferr_data %>% ggplot(aes(op_mg_p_l, op_conc_mg_p_l_hourly)) +
geom_point(size = 4) +
stat_smooth(method="lm", se= TRUE) +
labs(title = "Ferric Effluent vs. Dosing OP Concentrations",
x = "Dosing OP (mg/L)",
y = "Effluent OP (mg/L)") +
theme(plot.title = element_text(face="bold", size = 16, hjust = 0.5),
axis.text = element_text(size = 16),
axis.title = element_text(size = 16))
p2 <- alum_data %>% ggplot(aes(op_mg_p_l, op_conc_mg_p_l_hourly)) +
geom_point(size = 4) +
stat_smooth(method="lm", se= TRUE) +
labs(title = "Alum Effluent vs. Dosing OP Concentrations",
x = "Dosing OP (mg/L)",
y = "Effluent OP (mg/L)") +
theme(plot.title = element_text(face="bold", size = 16, hjust = 0.5),
axis.text = element_text(size = 16),
axis.title = element_text(size = 16))
grid.arrange(p1, p2, ncol = 2)
view(df)
setwd("~/Desktop/boulder/data")
load("../data/final-data.rda")
load("../data/boulderMoWater.rda")
x1 <- c(rep(1,72))
x1[1:32] <-0
x1
# mols of metal as covariate
x2 <- full_ancova %>% select(mols_of_metal_kmol_day,
influent_mgd_hourly_avg,
effluent_mgd,
primary_sludge_gmp_hourly_avg)
library(tidyverse)
library(fields)
library(lubridate)
library(latex2exp)
library(rstatix)
library(emmeans)
library(ggpubr)
library(tidyverse)
# mols of metal as covariate
x2 <- full_ancova %>% select(mols_of_metal_kmol_day,
influent_mgd_hourly_avg,
effluent_mgd,
primary_sludge_gmp_hourly_avg)
x1 <- c(rep(1,72))
x1[1:32] <-0
x1
#adding noises
y<-  5  - x1 + x2*.1 + .2* rnorm(72)
df<- data.frame( Y=y, X = x2, treatment=as.factor( x1))
view(df)
df<- data.frame( new =y, X = x2, treatment=as.factor( x1))
view(df)
df<- data.frame( Noise =y, X = x2, treatment=as.factor( x1))
view(df)
df<- data.frame( Noise =y, x2, treatment=as.factor( x1))
view(df)
#### plot of the data with two groups
df %>%
ggplot(aes(mols_of_metal_kmol_day,Noise.mols_of_metal_kmol_day, col = treatment)) +
geom_point()
##mols of metal vs noise added mols of metal
df %>%
ggplot(aes(influent_mgd_hourly_avg,Noise.influent_mgd_hourly_avg, col = treatment)) +
geom_point()
## effluent_mgd vs noise added effluent_mgd
df %>%
ggplot(aes(effluent_mgd,Noise.effluent_mgd, col = treatment)) +
geom_point()
df %>%
ggplot(aes(primary_sludge_gmp_hourly_avg,Noise.primary_sludge_gmp_hourly_avg, col = treatment)) +
geom_point()
# without covariate
obj0<- lm( y ~ treatment, data = df)
df<- data.frame( Noise = y, x2, treatment=as.factor( x1))
view(df)
obj0<- lm( Noise.mols_of_metal_kmol_day ~ treatment, data = df)
summary( obj0)
######### linear regression test of each synthetic data
# without covariate mols of metal
obj0<- lm(Noise.mols_of_metal_kmol_day ~ treatment, data = df)
summary( obj0)
# with covariate mols of metal
obj1<- lm( Noise.mols_of_metal_kmol_day ~ treatment + mols_of_metal_kmol_day , data = df)
summary( obj1)
# 20 observations each
N<- 20
# 0 or 1 if first or second treatment
x1<- c(rep( 1, N), rep(2, N) )
# covariate observed  note just a little overlap
#
x2<-  c( (1:N) , (1:N)+17 )
# here is the model for the response and some noise added
set.seed( 123)
y<-  5  - x1 + x2*.1 + .2* rnorm( 2*N)
# with the  - x1 the second treatment does not do as well at the first.
# data frame converting x1 to a factor (variable indicating groups)
df<- data.frame( Y=y, X= x2, treatment=as.factor( x1))
# a plot of the "data" with the two groups colored
plot( df$X,df$Y, col=df$treatment, pch=16)
# without covariate -- results are misleading
obj0<- lm( Y ~ treatment, data = df)
summary( obj0)
# with covariate shows  group one is better
obj1<- lm( Y ~ treatment + X , data = df)
summary( obj1)
obj0<- lm(Noise.mols_of_metal_kmol_day ~ treatment, data = df)
summary( obj0)
# with covariate mols of metal
obj1<- lm( Noise.mols_of_metal_kmol_day ~ treatment + mols_of_metal_kmol_day , data = df)
summary( obj1)
rm( list = ls() )
library(tidyverse)
library(ggplot2)
load("../data/final-data.rda")
load("../data/boulderMoWater.rda")
x1 <- c(rep(1,72))
x1[1:32] <-0
# mols of metal as covariate
x2 <- full_ancova %>% select(mols_of_metal_kmol_day,
influent_mgd_hourly_avg,
effluent_mgd,
primary_sludge_gmp_hourly_avg)
#adding noises
y<-  5  - x1 + x2*.1 + .2* rnorm(72)
df<- data.frame( Noise = y, x2, treatment=as.factor( x1))
view(df)
rm( list = ls() )
library(tidyverse)
library(ggplot2)
load("../data/final-data.rda")
load("../data/boulderMoWater.rda")
x1 <- c(rep(1,72))
x1[1:32] <-0
# mols of metal as covariate
x2 <- full_ancova %>% select(mols_of_metal_kmol_day,
influent_mgd_hourly_avg,
effluent_mgd,
primary_sludge_gmp_hourly_avg)
#adding noises
y<-  5  - x1 + x2*.1 + .2* rnorm(72)
df<- data.frame( Noise = y, x2, treatment=as.factor( x1))
view(df)
#### plot of the data with two groups
##mols of metal vs noise added mols of metal
df %>%
ggplot(aes(mols_of_metal_kmol_day,Noise.mols_of_metal_kmol_day, col = treatment)) +
geom_point()
##influent_mgd_hourly_avgl vs noise added influent_mgd_hourly_avg
df %>%
ggplot(aes(influent_mgd_hourly_avg,Noise.influent_mgd_hourly_avg, col = treatment)) +
geom_point()
## effluent_mgd vs noise added effluent_mgd
df %>%
ggplot(aes(effluent_mgd,Noise.effluent_mgd, col = treatment)) +
geom_point()
## primary_sludge_gmp_hourly_avg vs noise added primary_sludge_gmp_hourly_avg
df %>%
ggplot(aes(primary_sludge_gmp_hourly_avg,Noise.primary_sludge_gmp_hourly_avg, col = treatment)) +
geom_point()
######### linear regression test of each synthetic data
# without covariate mols of metal
obj0<- lm(Noise.mols_of_metal_kmol_day ~ treatment, data = df)
summary( obj0)
# with covariate mols of metal
obj1<- lm( Noise.mols_of_metal_kmol_day ~ treatment + mols_of_metal_kmol_day , data = df)
summary( obj1)
view(df)
# without covariate mols of metal
obj0<- lm(Noise.influent_mgd_hourly_avg ~ treatment, data = df)
summary( obj0)
# with covariate influent_mgd_hourly_avg
obj1<- lm( Noise.influent_mgd_hourly_avg ~ treatment + influent_mgd_hourly_avg , data = df)
summary( obj1)
# with covariate influent_mgd_hourly_avg
obj1<- lm( Noise.effluent_mgd ~ treatment + effluent_mgd , data = df)
############
# without covariate influent_mgd_hourly_avg
obj0<- lm(Noise.effluent_mgd ~ treatment, data = df)
summary( obj0)
summary( obj1)
###########
# without covariate primary_sludge_gmp_hourly_avg
obj0<- lm(Noise.primary_sludge_gmp_hourly_avg ~ treatment, data = df)
summary( obj0)
# with covariate primary_sludge_gmp_hourly_avg
obj1<- lm( Noise.primary_sludge_gmp_hourly_avg ~ treatment + primary_sludge_gmp_hourly_avg , data = df)
summary( obj1)
rm( list = ls())
library(tidyverse)
library(ggplot2)
rm( list = ls())
library(tidyverse)
library(ggplot2)
load("../data/final-data.rda")
load("../data/boulderMoWater.rda")
x1 <- c(rep(1,72))
x1[1:32] <-0
# mols of metal as covariate
x2 <- full_ancova %>% select(mols_of_metal_kmol_day,
influent_mgd_hourly_avg,
effluent_mgd,
primary_sludge_gmp_hourly_avg)
#adding noises
y<-  5  - x1 + x2*.1 + .2* rnorm(72)
df <- data.frame( Noise = y, x2, treatment=as.factor( x1))
view(df)
#### plot of the data with two groups
##mols of metal vs noise added mols of metal
df %>%
ggplot(aes(mols_of_metal_kmol_day,Noise.mols_of_metal_kmol_day, col = treatment)) +
geom_point()
##influent_mgd_hourly_avgl vs noise added influent_mgd_hourly_avg
df %>%
ggplot(aes(influent_mgd_hourly_avg,Noise.influent_mgd_hourly_avg, col = treatment)) +
geom_point()
## effluent_mgd vs noise added effluent_mgd
df %>%
ggplot(aes(effluent_mgd,Noise.effluent_mgd, col = treatment)) +
geom_point()
## primary_sludge_gmp_hourly_avg vs noise added primary_sludge_gmp_hourly_avg
df %>%
ggplot(aes(primary_sludge_gmp_hourly_avg,Noise.primary_sludge_gmp_hourly_avg, col = treatment)) +
geom_point()
######### linear regression test of each synthetic data
# without covariate mols of metal
obj0<- lm(Noise.mols_of_metal_kmol_day ~ treatment, data = df)
summary( obj0)
# with covariate mols of metal
obj1<- lm( Noise.mols_of_metal_kmol_day ~ treatment + mols_of_metal_kmol_day , data = df)
summary( obj1)
###########
# without covariate influent_mgd_hourly_avg
obj0<- lm(Noise.influent_mgd_hourly_avg ~ treatment, data = df)
summary( obj0)
# with covariate influent_mgd_hourly_avg
obj1<- lm( Noise.influent_mgd_hourly_avg ~ treatment + influent_mgd_hourly_avg , data = df)
summary( obj1)
############
# without covariate effluent_mgd
obj0<- lm(Noise.effluent_mgd ~ treatment, data = df)
summary( obj0)
# with covariate effluent_mgd
obj1<- lm( Noise.effluent_mgd ~ treatment + effluent_mgd , data = df)
summary( obj1)
###########
# without covariate primary_sludge_gmp_hourly_avg
obj0<- lm(Noise.primary_sludge_gmp_hourly_avg ~ treatment, data = df)
summary( obj0)
# with covariate primary_sludge_gmp_hourly_avg
obj1<- lm( Noise.primary_sludge_gmp_hourly_avg ~ treatment + primary_sludge_gmp_hourly_avg , data = df)
summary( obj1)
## effluent_mgd vs noise added effluent_mgd
df %>%
ggplot(aes(effluent_mgd,Noise.effluent_mgd, col = treatment)) +
geom_point()
rm( list = ls())
library(tidyverse)
library(ggplot2)
load("../data/final-data.rda")
load("../data/boulderMoWater.rda")
x1 <- c(rep(1,72))
x1[1:32] <-0
# mols of metal as covariate
x2 <- full_ancova %>% select(mols_of_metal_kmol_day,
influent_mgd_hourly_avg,
effluent_mgd,
primary_sludge_gmp_hourly_avg)
#adding noises
y<-  5  - x1 + x2*.1 + .2* rnorm(72)
df <- data.frame( Noise = y, x2, treatment=as.factor( x1))
view(df)
##mols of metal vs noise added mols of metal
df %>%
ggplot(aes(mols_of_metal_kmol_day,Noise.mols_of_metal_kmol_day, col = treatment)) +
geom_point()
rm( list = ls())
library(tidyverse)
rm( list = ls())
rm( list = ls())
library(tidyverse)
library(ggplot2)
load("../data/final-data.rda")
load("../data/boulderMoWater.rda")
x1 <- c(rep(1,72))
x1[1:32] <-0
# mols of metal as covariate
x2 <- full_ancova %>% select(mols_of_metal_kmol_day,
influent_mgd_hourly_avg,
effluent_mgd,
primary_sludge_gmp_hourly_avg)
#adding noises
y<-  5  - x1 + x2*.1 + .2* rnorm(72)
df <- data.frame( Noise = y, x2, treatment=as.factor( x1))
view(df)
##mols of metal vs noise added mols of metal
df %>%
ggplot(aes(mols_of_metal_kmol_day,Noise.mols_of_metal_kmol_day, col = treatment)) +
geom_point()
##influent_mgd_hourly_avgl vs noise added influent_mgd_hourly_avg
df %>%
ggplot(aes(influent_mgd_hourly_avg,Noise.influent_mgd_hourly_avg, col = treatment)) +
geom_point()
## effluent_mgd vs noise added effluent_mgd
df %>%
ggplot(aes(effluent_mgd,Noise.effluent_mgd, col = treatment)) +
geom_point()
## primary_sludge_gmp_hourly_avg vs noise added primary_sludge_gmp_hourly_avg
df %>%
ggplot(aes(primary_sludge_gmp_hourly_avg,Noise.primary_sludge_gmp_hourly_avg, col = treatment)) +
geom_point()
######### linear regression test of each synthetic data
# without covariate mols of metal
obj0<- lm(Noise.mols_of_metal_kmol_day ~ treatment, data = df)
setwd("~/Desktop/boulder/src")
load("../data/final-data.rda")
x1 <- c(rep(1,72))
x1[1:32] <-0
# mols of metal as covariate
x2 <- full_ancova %>% select(mols_of_metal_kmol_day,
influent_mgd_hourly_avg,
effluent_mgd,
primary_sludge_gmp_hourly_avg)
#adding noises
y<-  5  - x1 + x2*.1 + .2* rnorm(72)
df <- data.frame( Noise = y, x2, treatment=as.factor( x1))
##mols of metal vs noise added mols of metal
df %>%
ggplot(aes(mols_of_metal_kmol_day,Noise.mols_of_metal_kmol_day, col = treatment)) +
geom_point()
View(lab_daily)
