data <- read_csv("colorado_tds.csv")
data <- read_csv("colorado_tds.csv")
HATTIE ...
```{r}
leesPlot <- ggplot(data, aes(x=as.Date(date), y=lees)) +
geom_line() +
xlab("Date") +
ylab("Lees Ferry TDS")
```
(.1 * 100)
(.1 * 100) + (.1 * 97.37) + (.2 * 80.36) + (.2 * 100) + (.2 * 92)
(.1 * 100) + (.1 * 97.37) + (.2 * 80.36) + (.2 * 100) + (.2 * 92) + (.2 * 100)
(.1 * 100) + (.1 * 97.37) + (.2 * 80.36) + (.2 * 100) + (.2 * 92) + (.2 * 76)
(.1 * 100) + (.1 * 97.37) + (.2 * 80.36) + (.2 * 100) + (.2 * 92) + (.2 * 80)
# plot the points and linear fit by coagulant; test for linearity with covariate
ggplot( partial_ancova1, aes(influent_mgd_hourly_avg, phos_change, color = coagulant) ) +
geom_point( aes(shape = coagulant), size = 2, alpha = .75 ) +
geom_smooth( method='lm', se = TRUE ) +
stat_regline_equation( aes( label = paste(..eq.label.., ..rr.label.., sep = '~~~') ) , size = 3 ) +
scale_color_brewer(palette = "Dark2") +
theme( legend.position = "right",
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
legend.text = element_text(size = 12),
legend.title = element_text(size = 14),
plot.title = element_text( face="bold", size = 16, hjust = 0.5 ) ) +
labs(x = "Influent Hourly Average (mgd)",
y = "Change in Phosphorus (mg/L)",
title = "Influent Vs Change in Phosphorus",
color = "Coagulant")  +
guides(shape = FALSE)
#### Clear environment and load libraries ####
rm( list = ls() )
library(tidyverse)
library(lubridate)
library(rstatix)
library(emmeans)
library(ggpubr)
##### Make sure src is the current working directory and load data ####
load("../data/final-data.rda")
#### Set the general plot them for all plots ####
theme_set(theme_bw())
theme_update(panel.background = element_blank(), axis.line = element_line(colour = "black"))
#### Identify linear relationships for possible covariates. See row/column 5 ####
pairs(partial_ancova)
#### Influent Covariate ANCOVA Analysis ####
partial_ancova1 <- partial_ancova %>% select(coagulant, phos_change, influent_mgd_hourly_avg)
# shows the 'linear' relationship between the outcome variable and covarient
plot(partial_ancova1$influent_mgd_hourly_avg, partial_ancova1$phos_change)
# plot the points and linear fit by coagulant; test for linearity with covariate
ggplot( partial_ancova1, aes(influent_mgd_hourly_avg, phos_change, color = coagulant) ) +
geom_point( aes(shape = coagulant), size = 2, alpha = .75 ) +
geom_smooth( method='lm', se = TRUE ) +
stat_regline_equation( aes( label = paste(..eq.label.., ..rr.label.., sep = '~~~') ) , size = 3 ) +
scale_color_brewer(palette = "Dark2") +
theme( legend.position = "right",
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
legend.text = element_text(size = 12),
legend.title = element_text(size = 14),
plot.title = element_text( face="bold", size = 16, hjust = 0.5 ) ) +
labs(x = "Influent Hourly Average (mgd)",
y = "Change in Phosphorus (mg/L)",
title = "Influent Vs Change in Phosphorus",
color = "Coagulant")  +
guides(shape = FALSE)
# test for homogeneity; compares the behavior (slope) with the addition of covariate
partial_test1 <- anova_test(phos_change ~ influent_mgd_hourly_avg * coagulant, data = partial_ancova1)
get_anova_table(partial_test1)
# estimate marginal means; anova test with the addition of the covariate---test for p < 0.05
partial_ancova1$coagulant <- as.character(partial_ancova1$coagulant)
em1 <- emmeans_test(partial_ancova1, phos_change ~ coagulant , covariate = influent_mgd_hourly_avg,
p.adjust.method = "bonferroni")
knitr::kable( em1, digits = 3, format = "pandoc", caption = "Influent ANOVA Table" )
#### Mols of metal Covariate ANCOVA Analysis ####
partial_ancova2 <- partial_ancova %>% select(coagulant,phos_change,mols_of_metal_kmol_day)
plot(partial_ancova2$mols_of_metal_kmol_day, partial_ancova2$phos_change)
ggplot( partial_ancova2, aes(mols_of_metal_kmol_day, phos_change, color = coagulant) ) +
geom_point( aes(shape = coagulant), size = 2, alpha = .75 ) +
geom_smooth( method='lm', se = TRUE ) +
stat_regline_equation( aes( label = paste(..eq.label.., ..rr.label.., sep = '~~~') ) , size = 3 ) +
scale_color_brewer(palette = "Dark2") +
theme( legend.position = "right",
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
legend.text = element_text(size = 12),
legend.title = element_text(size = 14),
plot.title = element_text( face="bold", size = 16, hjust = 0.5 ) ) +
labs(x = "Daily Mols of Metal (Kmol)",
y = "Change in Phosphorus (mg/L)",
title = "Mols of Metal Vs Change in Phosphorus",
color = "Coagulant")  +
guides(shape = FALSE)
partial_test2 <- anova_test(phos_change ~ mols_of_metal_kmol_day * coagulant, data = partial_ancova2)
get_anova_table(partial_test2)
partial_ancova2$coagulant <- as.character(partial_ancova2$coagulant)
em2 <- emmeans_test(partial_ancova2, phos_change ~ coagulant , covariate = mols_of_metal_kmol_day,
p.adjust.method = "bonferroni")
#### Clear environment and load libraries ####
rm( list = ls() )
library(tidyverse)
library(lubridate)
library(rstatix)
library(emmeans)
library(ggpubr)
##### Make sure src is the current working directory and load data ####
load("../data/final-data.rda")
setwd("~/")
setwd("~/Desktop/MoWater/boulder/src")
#### Clear environment and load libraries ####
rm( list = ls() )
library(tidyverse)
library(lubridate)
library(rstatix)
library(emmeans)
library(ggpubr)
##### Make sure src is the current working directory and load data ####
load("../data/final-data.rda")
#### Set the general plot them for all plots ####
theme_set(theme_bw())
theme_update(panel.background = element_blank(), axis.line = element_line(colour = "black"))
#### Identify linear relationships for possible covariates. See row/column 5 ####
pairs(partial_ancova)
#### Influent Covariate ANCOVA Analysis ####
partial_ancova1 <- partial_ancova %>% select(coagulant, phos_change, influent_mgd_hourly_avg)
# shows the 'linear' relationship between the outcome variable and covarient
plot(partial_ancova1$influent_mgd_hourly_avg, partial_ancova1$phos_change)
# plot the points and linear fit by coagulant; test for linearity with covariate
ggplot( partial_ancova1, aes(influent_mgd_hourly_avg, phos_change, color = coagulant) ) +
geom_point( aes(shape = coagulant), size = 2, alpha = .75 ) +
geom_smooth( method='lm', se = TRUE ) +
stat_regline_equation( aes( label = paste(..eq.label.., ..rr.label.., sep = '~~~') ) , size = 3 ) +
scale_color_brewer(palette = "Dark2") +
theme( legend.position = "right",
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
legend.text = element_text(size = 12),
legend.title = element_text(size = 14),
plot.title = element_text( face="bold", size = 16, hjust = 0.5 ) ) +
labs(x = "Influent Hourly Average (mgd)",
y = "Change in Phosphorus (mg/L)",
title = "Influent Vs Change in Phosphorus",
color = "Coagulant")  +
guides(shape = FALSE)
# test for homogeneity; compares the behavior (slope) with the addition of covariate
partial_test1 <- anova_test(phos_change ~ influent_mgd_hourly_avg * coagulant, data = partial_ancova1)
get_anova_table(partial_test1)
# estimate marginal means; anova test with the addition of the covariate---test for p < 0.05
partial_ancova1$coagulant <- as.character(partial_ancova1$coagulant)
em1 <- emmeans_test(partial_ancova1, phos_change ~ coagulant , covariate = influent_mgd_hourly_avg,
p.adjust.method = "bonferroni")
knitr::kable( em1, digits = 3, format = "pandoc", caption = "Influent ANOVA Table" )
#### Mols of metal Covariate ANCOVA Analysis ####
partial_ancova2 <- partial_ancova %>% select(coagulant,phos_change,mols_of_metal_kmol_day)
plot(partial_ancova2$mols_of_metal_kmol_day, partial_ancova2$phos_change)
ggplot( partial_ancova2, aes(mols_of_metal_kmol_day, phos_change, color = coagulant) ) +
geom_point( aes(shape = coagulant), size = 2, alpha = .75 ) +
geom_smooth( method='lm', se = TRUE ) +
stat_regline_equation( aes( label = paste(..eq.label.., ..rr.label.., sep = '~~~') ) , size = 3 ) +
scale_color_brewer(palette = "Dark2") +
theme( legend.position = "right",
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
legend.text = element_text(size = 12),
legend.title = element_text(size = 14),
plot.title = element_text( face="bold", size = 16, hjust = 0.5 ) ) +
labs(x = "Daily Mols of Metal (Kmol)",
y = "Change in Phosphorus (mg/L)",
title = "Mols of Metal Vs Change in Phosphorus",
color = "Coagulant")  +
guides(shape = FALSE)
partial_test2 <- anova_test(phos_change ~ mols_of_metal_kmol_day * coagulant, data = partial_ancova2)
get_anova_table(partial_test2)
partial_ancova2$coagulant <- as.character(partial_ancova2$coagulant)
em2 <- emmeans_test(partial_ancova2, phos_change ~ coagulant , covariate = mols_of_metal_kmol_day,
p.adjust.method = "bonferroni")
knitr::kable( em2, digits = 3, format = "pandoc", caption = "Mols of Metal ANOVA Table" )
#### Primary Sludge Covariate ANCOVA Analysis ####
partial_ancova3 <- partial_ancova %>% select(coagulant,phos_change,primary_sludge_gmp_hourly_avg)
plot(partial_ancova3$primary_sludge_gmp_hourly_avg, partial_ancova3$phos_change)
ggplot( partial_ancova3, aes(primary_sludge_gmp_hourly_avg, phos_change, color = coagulant) ) +
geom_point( aes(shape = coagulant), size = 2, alpha = .75 ) +
geom_smooth( method='lm', se = TRUE ) +
stat_regline_equation( aes( label = paste(..eq.label.., ..rr.label.., sep = '~~~') ) , size = 3 ) +
scale_color_brewer(palette = "Dark2") +
theme( legend.position = "right",
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
legend.text = element_text(size = 12),
legend.title = element_text(size = 14),
plot.title = element_text( face="bold", size = 16, hjust = 0.5 ) ) +
labs(x = "Primary Sludge Hourly Average (gmp)",
y = "Change in Phosphorus (mg/L)",
title = "Primary Sludge Vs Change in Phosphorus",
color = "Coagulant")  +
guides(shape = FALSE)
partial_test3 <- anova_test(phos_change ~ primary_sludge_gmp_hourly_avg * coagulant, data = partial_ancova3)
get_anova_table(partial_test3)
partial_ancova3$coagulant <- as.character(partial_ancova3$coagulant)
em3 <- emmeans_test(partial_ancova3, phos_change ~ coagulant , covariate = primary_sludge_gmp_hourly_avg,
p.adjust.method = "bonferroni")
knitr::kable( em3, digits = 3, format = "pandoc", caption = "Primary Sludge ANOVA Table" )
#### Effluent Flow Covariate ANCOVA Analysis ####
partial_ancova4 <- partial_ancova %>% select(coagulant,phos_change,effluent_mgd)
plot(partial_ancova4$effluent_mgd, partial_ancova4$phos_change)
ggplot( partial_ancova4, aes(effluent_mgd, phos_change, color = coagulant) ) +
geom_point( aes(shape = coagulant), size = 2, alpha = .75 ) +
geom_smooth( method='lm', se = TRUE ) +
stat_regline_equation( aes( label = paste(..eq.label.., ..rr.label.., sep = '~~~') ) , size = 3 ) +
scale_color_brewer(palette = "Dark2") +
theme( legend.position = "right",
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
legend.text = element_text(size = 12),
legend.title = element_text(size = 14),
plot.title = element_text( face="bold", size = 16, hjust = 0.5 ) ) +
labs(x = "Effluent (mgd)",
y = "Change in Phosphorus (mg/L)",
title = "Primary Sludge Vs Change in Phosphorus",
color = "Coagulant")  +
guides(shape = FALSE)
partial_test4 <- anova_test(phos_change ~ effluent_mgd * coagulant, data = partial_ancova4)
get_anova_table(partial_test4)
partial_ancova4$coagulant <- as.character(partial_ancova4$coagulant)
em4 <- emmeans_test(partial_ancova4, phos_change ~ coagulant , covariate = effluent_mgd,
p.adjust.method = "bonferroni")
knitr::kable( em4, digits = 3, format = "pandoc", caption = "Effluent ANOVA Table" )
#- equality of error variances across groups, normal and uncorrelated error terms
plot(residuals(lm(phos_change~influent_mgd_hourly_avg+coagulant, data = partial_ancova1)))
abline()
#- equality of error variances across groups, normal and uncorrelated error terms
plot(residuals(lm(phos_change~influent_mgd_hourly_avg+coagulant, data = partial_ancova1)))
abline()
rm( list = ls())
library(tidyverse)
library(ggplot2)
load("../data/final-data.rda")
load("../data/boulderMoWater.rda")
x1 <- c(rep(1,72))
x1[full_ancova$coagulant == "Ferric"] <- 0
# mols of metal as covariate
x2 <- full_ancova %>% select(mols_of_metal_kmol_day,
influent_mgd_hourly_avg,
effluent_mgd,
primary_sludge_gmp_hourly_avg)
#adding noises
y<-  5  - x1 + x2*.1 + .2* rnorm(72)
df <- data.frame( Noise = y, x2, treatment=as.factor( x1))
##mols of metal vs noise added mols of metal
df %>%
ggplot(aes(mols_of_metal_kmol_day,Noise.mols_of_metal_kmol_day, col = treatment)) +
geom_point()
##influent_mgd_hourly_avgl vs noise added influent_mgd_hourly_avg
df %>%
ggplot(aes(influent_mgd_hourly_avg,Noise.influent_mgd_hourly_avg, col = treatment)) +
geom_point()
## effluent_mgd vs noise added effluent_mgd
df %>%
ggplot(aes(effluent_mgd,Noise.effluent_mgd, col = treatment)) +
geom_point()
## primary_sludge_gmp_hourly_avg vs noise added primary_sludge_gmp_hourly_avg
df %>%
ggplot(aes(primary_sludge_gmp_hourly_avg,Noise.primary_sludge_gmp_hourly_avg, col = treatment)) +
geom_point()
######### linear regression test of each synthetic data
# without covariate mols of metal
obj0<- lm(Noise.mols_of_metal_kmol_day ~ treatment, data = df)
summary( obj0)
# with covariate mols of metal
obj1<- lm( Noise.mols_of_metal_kmol_day ~ treatment + mols_of_metal_kmol_day , data = df)
summary( obj1)
###########
# without covariate influent_mgd_hourly_avg
obj0<- lm(Noise.influent_mgd_hourly_avg ~ treatment, data = df)
summary( obj0)
# with covariate influent_mgd_hourly_avg
obj1<- lm( Noise.influent_mgd_hourly_avg ~ treatment + influent_mgd_hourly_avg , data = df)
summary( obj1)
############
# without covariate effluent_mgd
obj0<- lm(Noise.effluent_mgd ~ treatment, data = df)
summary( obj0)
# with covariate effluent_mgd
obj1<- lm( Noise.effluent_mgd ~ treatment + effluent_mgd , data = df)
summary( obj1)
###########
# without covariate primary_sludge_gmp_hourly_avg
obj0<- lm(Noise.primary_sludge_gmp_hourly_avg ~ treatment, data = df)
summary( obj0)
# with covariate primary_sludge_gmp_hourly_avg
obj1<- lm( Noise.primary_sludge_gmp_hourly_avg ~ treatment + primary_sludge_gmp_hourly_avg , data = df)
summary( obj1)
View(df)
# Shapiro Wilk test for normality of residuals
parial_model1 <- lm(phos_change ~ influent_mgd_hourly_avg + coagulant, data = partial_ancova1)
#### Clear environment and load libraries ####
rm( list = ls() )
library(tidyverse)
library(lubridate)
library(rstatix)
library(emmeans)
library(ggpubr)
##### Make sure src is the current working directory and load data ####
load("../data/final-data.rda")
#### Set the general plot them for all plots ####
theme_set(theme_bw())
theme_update(panel.background = element_blank(), axis.line = element_line(colour = "black"))
#### Identify linear relationships for possible covariates. See row/column 5 ####
pairs(partial_ancova)
#### Influent Covariate ANCOVA Analysis ####
partial_ancova1 <- partial_ancova %>% select(coagulant, phos_change, influent_mgd_hourly_avg)
# shows the 'linear' relationship between the outcome variable and covarient
plot(partial_ancova1$influent_mgd_hourly_avg, partial_ancova1$phos_change)
# plot the points and linear fit by coagulant; test for linearity with covariate
ggplot( partial_ancova1, aes(influent_mgd_hourly_avg, phos_change, color = coagulant) ) +
geom_point( aes(shape = coagulant), size = 2, alpha = .75 ) +
geom_smooth( method='lm', se = TRUE ) +
stat_regline_equation( aes( label = paste(..eq.label.., ..rr.label.., sep = '~~~') ) , size = 3 ) +
scale_color_brewer(palette = "Dark2") +
theme( legend.position = "right",
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
legend.text = element_text(size = 12),
legend.title = element_text(size = 14),
plot.title = element_text( face="bold", size = 16, hjust = 0.5 ) ) +
labs(x = "Influent Hourly Average (mgd)",
y = "Change in Phosphorus (mg/L)",
title = "Influent Vs Change in Phosphorus",
color = "Coagulant")  +
guides(shape = FALSE)
# test for homogeneity; compares the behavior (slope) with the addition of covariate
partial_test1 <- anova_test(phos_change ~ influent_mgd_hourly_avg * coagulant, data = partial_ancova1)
get_anova_table(partial_test1)
# estimate marginal means; anova test with the addition of the covariate---test for p < 0.05
partial_ancova1$coagulant <- as.character(partial_ancova1$coagulant)
em1 <- emmeans_test(partial_ancova1, phos_change ~ coagulant , covariate = influent_mgd_hourly_avg,
p.adjust.method = "bonferroni")
# Shapiro Wilk test for normality of residuals
parial_model1 <- lm(phos_change ~ influent_mgd_hourly_avg + coagulant, data = partial_ancova1)
partial_model1.metrics <- augment(parial_model1) %>%
select(-.hat, -.sigma, -.fitted, -.se.fit) # Remove details
shapiro_test(model1.metrics$.resid) # if not significant assumption is maintained
shapiro_test(partial_model1.metrics$.resid) # if not significant assumption is maintained
# Leven's test for homogeneity of variances
partial_model1.metrics %>% levene_test(.resid ~ as.factor(coagulant)) # if not significant assumption is maintained
# outliers
partial_model1.metrics %>%
filter(abs(.std.resid) > 3) %>%
as.data.frame()
parial_model2 <- lm(phos_change ~ mols_of_metal_kmol_day + coagulant, data = partial_ancova2)
#### Mols of metal Covariate ANCOVA Analysis ####
partial_ancova2 <- partial_ancova %>% select(coagulant,phos_change,mols_of_metal_kmol_day)
plot(partial_ancova2$mols_of_metal_kmol_day, partial_ancova2$phos_change)
ggplot( partial_ancova2, aes(mols_of_metal_kmol_day, phos_change, color = coagulant) ) +
geom_point( aes(shape = coagulant), size = 2, alpha = .75 ) +
geom_smooth( method='lm', se = TRUE ) +
stat_regline_equation( aes( label = paste(..eq.label.., ..rr.label.., sep = '~~~') ) , size = 3 ) +
scale_color_brewer(palette = "Dark2") +
theme( legend.position = "right",
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
legend.text = element_text(size = 12),
legend.title = element_text(size = 14),
plot.title = element_text( face="bold", size = 16, hjust = 0.5 ) ) +
labs(x = "Daily Mols of Metal (Kmol)",
y = "Change in Phosphorus (mg/L)",
title = "Mols of Metal Vs Change in Phosphorus",
color = "Coagulant")  +
guides(shape = FALSE)
partial_test2 <- anova_test(phos_change ~ mols_of_metal_kmol_day * coagulant, data = partial_ancova2)
get_anova_table(partial_test2)
partial_ancova2$coagulant <- as.character(partial_ancova2$coagulant)
em2 <- emmeans_test(partial_ancova2, phos_change ~ coagulant , covariate = mols_of_metal_kmol_day,
p.adjust.method = "bonferroni")
parial_model2 <- lm(phos_change ~ mols_of_metal_kmol_day + coagulant, data = partial_ancova2)
partial_model2.metrics <- augment(parial_model2) %>%
select(-.hat, -.sigma, -.fitted, -.se.fit) # Remove details
shapiro_test(partial_model2.metrics$.resid) # if not significant assumption is maintained
partial_model2.metrics %>% levene_test(.resid ~ as.factor(coagulant)) # if not significant assumption is maintained
partial_model2.metrics %>%
filter(abs(.std.resid) > 3) %>%
as.data.frame()
#### Primary Sludge Covariate ANCOVA Analysis ####
partial_ancova3 <- partial_ancova %>% select(coagulant,phos_change,primary_sludge_gmp_hourly_avg)
plot(partial_ancova3$primary_sludge_gmp_hourly_avg, partial_ancova3$phos_change)
ggplot( partial_ancova3, aes(primary_sludge_gmp_hourly_avg, phos_change, color = coagulant) ) +
geom_point( aes(shape = coagulant), size = 2, alpha = .75 ) +
geom_smooth( method='lm', se = TRUE ) +
stat_regline_equation( aes( label = paste(..eq.label.., ..rr.label.., sep = '~~~') ) , size = 3 ) +
scale_color_brewer(palette = "Dark2") +
theme( legend.position = "right",
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
legend.text = element_text(size = 12),
legend.title = element_text(size = 14),
plot.title = element_text( face="bold", size = 16, hjust = 0.5 ) ) +
labs(x = "Primary Sludge Hourly Average (gmp)",
y = "Change in Phosphorus (mg/L)",
title = "Primary Sludge Vs Change in Phosphorus",
color = "Coagulant")  +
guides(shape = FALSE)
partial_test3 <- anova_test(phos_change ~ primary_sludge_gmp_hourly_avg * coagulant, data = partial_ancova3)
get_anova_table(partial_test3)
partial_ancova3$coagulant <- as.character(partial_ancova3$coagulant)
em3 <- emmeans_test(partial_ancova3, phos_change ~ coagulant , covariate = primary_sludge_gmp_hourly_avg,
p.adjust.method = "bonferroni")
parial_model3 <- lm(phos_change ~ primary_sludge_gmp_hourly_avg + coagulant, data = partial_ancova3)
partial_model3.metrics <- augment(parial_model3) %>%
select(-.hat, -.sigma, -.fitted, -.se.fit) # Remove details
shapiro_test(partial_model3.metrics$.resid) # if not significant assumption is maintained
partial_model3.metrics %>% levene_test(.resid ~ as.factor(coagulant)) # if not significant assumption is maintained
partial_model3.metrics %>%
filter(abs(.std.resid) > 3) %>%
as.data.frame()
#### Effluent Flow Covariate ANCOVA Analysis ####
partial_ancova4 <- partial_ancova %>% select(coagulant,phos_change,effluent_mgd)
plot(partial_ancova4$effluent_mgd, partial_ancova4$phos_change)
ggplot( partial_ancova4, aes(effluent_mgd, phos_change, color = coagulant) ) +
geom_point( aes(shape = coagulant), size = 2, alpha = .75 ) +
geom_smooth( method='lm', se = TRUE ) +
stat_regline_equation( aes( label = paste(..eq.label.., ..rr.label.., sep = '~~~') ) , size = 3 ) +
scale_color_brewer(palette = "Dark2") +
theme( legend.position = "right",
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
legend.text = element_text(size = 12),
legend.title = element_text(size = 14),
plot.title = element_text( face="bold", size = 16, hjust = 0.5 ) ) +
labs(x = "Effluent (mgd)",
y = "Change in Phosphorus (mg/L)",
title = "Primary Sludge Vs Change in Phosphorus",
color = "Coagulant")  +
guides(shape = FALSE)
partial_test4 <- anova_test(phos_change ~ effluent_mgd * coagulant, data = partial_ancova4)
get_anova_table(partial_test4)
partial_ancova4$coagulant <- as.character(partial_ancova4$coagulant)
em4 <- emmeans_test(partial_ancova4, phos_change ~ coagulant , covariate = effluent_mgd,
p.adjust.method = "bonferroni")
parial_model4 <- lm(phos_change ~ effluent_mgd + coagulant, data = partial_ancova4)
partial_model4.metrics <- augment(parial_model4) %>%
select(-.hat, -.sigma, -.fitted, -.se.fit) # Remove details
shapiro_test(partial_model4.metrics$.resid) # if not significant assumption is maintained
partial_model4.metrics %>% levene_test(.resid ~ as.factor(coagulant)) # if not significant assumption is maintained
partial_model4.metrics %>%
filter(abs(.std.resid) > 3) %>%
as.data.frame()
knitr::kable( em4, digits = 3, format = "pandoc", caption = "Effluent ANOVA Table" )
em5 <- emmeans_test(partial_ancova5, phos_change ~ coagulant , covariate = c(influent_mgd_hourly_avg,
mols_of_metal_kmol_day,
primary_sludge_gmp_hourly_avg,
effluent_mgd),
p.adjust.method = "bonferroni")
partial_ancova5 <- partial_ancova %>% select(coagulant,phos_change,
influent_mgd_hourly_avg,
mols_of_metal_kmol_day,
primary_sludge_gmp_hourly_avg,
effluent_mgd)
fit5 <- anova_test(phos_change ~ influent_mgd_hourly_avg +
mols_of_metal_kmol_day +
primary_sludge_gmp_hourly_avg +
effluent_mgd +
coagulant,
data = partial_ancova5)
get_anova_table(fit5)
partial_ancova5$coagulant <- as.character(partial_ancova5$coagulant)
em5 <- emmeans_test(partial_ancova5, phos_change ~ coagulant , covariate = c(influent_mgd_hourly_avg,
mols_of_metal_kmol_day,
primary_sludge_gmp_hourly_avg,
effluent_mgd),
p.adjust.method = "bonferroni")
parial_model5 <- lm(phos_change ~ effluent_mgd +
influent_mgd_hourly_avg +
primary_sludge_gmp_hourly_avg +
mols_of_metal_kmol_day
+ coagulant, data = partial_ancova4)
parial_model5 <- lm(phos_change ~ effluent_mgd *
influent_mgd_hourly_avg *
primary_sludge_gmp_hourly_avg *
mols_of_metal_kmol_day
+ coagulant, data = partial_ancova4)
parial_model5 <- lm(phos_change ~ effluent_mgd *
influent_mgd_hourly_avg *
primary_sludge_gmp_hourly_avg *
mols_of_metal_kmol_day *
coagulant, data = partial_ancova4)
#### Multiple Covariate ANCOVA Analysis ####
partial_ancova5 <- partial_ancova %>% select(coagulant,phos_change, influent_mgd_hourly_avg,
mols_of_metal_kmol_day,
primary_sludge_gmp_hourly_avg,
effluent_mgd)
partial_test5 <- anova_test(phos_change ~ influent_mgd_hourly_avg *
mols_of_metal_kmol_day *
primary_sludge_gmp_hourly_avg *
effluent_mgd *
coagulant, data = partial_ancova5)
get_anova_table(partial_test5)
partial_ancova5$coagulant <- as.character(partial_ancova5$coagulant)
em5 <- emmeans_test(partial_ancova5, phos_change ~ coagulant , covariate = influent_mgd_hourly_avg,
mols_of_metal_kmol_day,
primary_sludge_gmp_hourly_avg,
effluent_mgd,
p.adjust.method = "bonferroni")
em5 <- emmeans_test(partial_ancova5, phos_change ~ coagulant , covariate = influent_mgd_hourly_avg +
mols_of_metal_kmol_day +
primary_sludge_gmp_hourly_avg +
effluent_mgd,
p.adjust.method = "bonferroni")
em5 <- emmeans_test(partial_ancova5, phos_change ~ coagulant , covariate = influent_mgd_hourly_avg +
mols_of_metal_kmol_day +
primary_sludge_gmp_hourly_avg +
effluent_mgd,
p.adjust.method = "bonferroni")
